"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getMostRecentChromedriver = getMostRecentChromedriver;
exports.default = exports.CD_VER = exports.CHROMEDRIVER_CHROME_MAPPING = exports.Chromedriver = void 0;

require("source-map-support/register");

var _events = _interopRequireDefault(require("events"));

var _appiumBaseDriver = require("appium-base-driver");

var _child_process = _interopRequireDefault(require("child_process"));

var _appiumSupport = require("appium-support");

var _asyncbox = require("asyncbox");

var _teen_process = require("teen_process");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _utils = require("./utils");

var _semver = _interopRequireDefault(require("semver"));

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

const log = _appiumSupport.logger.getLogger('Chromedriver');

const DEFAULT_HOST = '127.0.0.1';
const DEFAULT_PORT = 9515;
const CHROMEDRIVER_CHROME_MAPPING = {
  '2.44': '69.0.3497',
  '2.43': '69.0.3497',
  '2.42': '68.0.3440',
  '2.41': '67.0.3396',
  '2.40': '66.0.3359',
  '2.39': '66.0.3359',
  '2.38': '65.0.3325',
  '2.37': '64.0.3282',
  '2.36': '63.0.3239',
  '2.35': '62.0.3202',
  '2.34': '61.0.3163',
  '2.33': '60.0.3112',
  '2.32': '59.0.3071',
  '2.31': '58.0.3029',
  '2.30': '58.0.3029',
  '2.29': '57.0.2987',
  '2.28': '55.0.2883',
  '2.27': '54.0.2840',
  '2.26': '53.0.2785',
  '2.25': '53.0.2785',
  '2.24': '52.0.2743',
  '2.23': '51.0.2704',
  '2.22': '49.0.2623',
  '2.21': '46.0.2490',
  '2.20': '43.0.2357',
  '2.19': '43.0.2357',
  '2.18': '43.0.2357',
  '2.17': '42.0.2311',
  '2.16': '42.0.2311',
  '2.15': '40.0.2214',
  '2.14': '39.0.2171',
  '2.13': '38.0.2125',
  '2.12': '36.0.1985',
  '2.11': '36.0.1985',
  '2.10': '33.0.1751',
  '2.9': '31.0.1650',
  '2.8': '30.0.1573',
  '2.7': '30.0.1573',
  '2.6': '29.0.1545',
  '2.5': '29.0.1545',
  '2.4': '29.0.1545',
  '2.3': '28.0.1500',
  '2.2': '27.0.1453',
  '2.1': '27.0.1453',
  '2.0': '27.0.1453'
};
exports.CHROMEDRIVER_CHROME_MAPPING = CHROMEDRIVER_CHROME_MAPPING;
const CHROME_BUNDLE_ID = 'com.android.chrome';
const WEBVIEW_BUNDLE_IDS = ['com.google.android.webview', 'com.android.webview'];
const CHROMEDRIVER_TUTORIAL = 'https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/web/chromedriver.md';
const CD_VER = process.env.npm_config_chromedriver_version || process.env.CHROMEDRIVER_VERSION || getMostRecentChromedriver();
exports.CD_VER = CD_VER;
const CD_VERSION_TIMEOUT = 5000;

function getMostRecentChromedriver(mapping = CHROMEDRIVER_CHROME_MAPPING) {
  if (_lodash.default.isEmpty(mapping)) {
    throw new Error('Unable to get most recent Chromedriver from empty mapping');
  }

  return _lodash.default.keys(mapping).map(_semver.default.coerce).sort(_semver.default.rcompare).map(v => `${_semver.default.major(v)}.${_semver.default.minor(v)}`)[0];
}

class Chromedriver extends _events.default.EventEmitter {
  constructor(args = {}) {
    super();
    const {
      host = DEFAULT_HOST,
      port = DEFAULT_PORT,
      useSystemExecutable = false,
      executable,
      executableDir = (0, _utils.getChromedriverDir)(),
      bundleId,
      mappingPath,
      cmdArgs,
      adb,
      verbose,
      logPath,
      disableBuildCheck
    } = args;
    this.proxyHost = host;
    this.proxyPort = port;
    this.adb = adb;
    this.cmdArgs = cmdArgs;
    this.proc = null;
    this.useSystemExecutable = useSystemExecutable;
    this.chromedriver = executable;
    this.executableDir = executableDir;
    this.mappingPath = mappingPath;
    this.bundleId = bundleId;
    this.executableVerified = false;
    this.state = Chromedriver.STATE_STOPPED;
    this.jwproxy = new _appiumBaseDriver.JWProxy({
      server: this.proxyHost,
      port: this.proxyPort
    });
    this.verbose = verbose;
    this.logPath = logPath;
    this.disableBuildCheck = !!disableBuildCheck;
  }

  async getMapping() {
    let mapping = CHROMEDRIVER_CHROME_MAPPING;

    if (this.mappingPath) {
      log.debug(`Attempting to use Chromedriver-Chrome mapping from '${this.mappingPath}'`);

      if (!(await _appiumSupport.fs.exists(this.mappingPath))) {
        log.warn(`No file found at '${this.mappingPath}'. Using default mapping`);
      } else {
        try {
          mapping = JSON.parse((await _appiumSupport.fs.readFile(this.mappingPath)));
        } catch (err) {
          log.error(`Error parsing mapping from '${this.mappingPath}': ${err.message}`);
          log.warn('Using default mapping');
        }
      }
    }

    for (const [cdVersion, chromeVersion] of _lodash.default.toPairs(mapping)) {
      mapping[cdVersion] = _semver.default.coerce(chromeVersion);
    }

    return mapping;
  }

  async getChromedrivers(mapping) {
    const executables = await _appiumSupport.fs.glob(`${this.executableDir}/*`);
    log.debug(`Found ${executables.length} executable${executables.length === 1 ? '' : 's'} ` + `in '${this.executableDir}'`);
    const cds = (await (0, _asyncbox.asyncmap)(executables, async function (executable) {
      const logError = ({
        message,
        stdout = null,
        stderr = null
      }) => {
        let errMsg = `Cannot retrieve version number from '${_path.default.basename(executable)}' Chromedriver binary. ` + `Make sure it returns a valid version string in response to '--version' command line argument. ${message}`;

        if (stdout) {
          errMsg += `\nStdout: ${stdout}`;
        }

        if (stderr) {
          errMsg += `\nStderr: ${stderr}`;
        }

        log.warn(errMsg);
        return null;
      };

      let stdout;
      let stderr;

      try {
        ({
          stdout,
          stderr
        } = await (0, _teen_process.exec)(executable, ['--version'], {
          timeout: CD_VERSION_TIMEOUT
        }));
      } catch (err) {
        if (!(err.message || '').includes('timed out') && !(err.stdout || '').includes('Starting ChromeDriver')) {
          return logError(err);
        }

        stdout = err.stdout;
      }

      const match = /ChromeDriver\s+\(?v?([\d.]+)\)?/i.exec(stdout);

      if (!match) {
        return logError({
          message: 'Cannot parse the version string',
          stdout,
          stderr
        });
      }

      const versionObj = _semver.default.coerce(match[1], true);

      if (!versionObj) {
        return logError({
          message: 'Cannot coerce the version number',
          stdout,
          stderr
        });
      }

      const version = `${versionObj.major}.${versionObj.minor}`;
      return {
        executable,
        version,
        minCDVersion: mapping[version]
      };
    })).filter(cd => !!cd).sort((a, b) => _semver.default.gte(_semver.default.coerce(b.version), _semver.default.coerce(a.version)) ? 1 : -1);

    if (_lodash.default.isEmpty(cds)) {
      log.errorAndThrow(`No Chromedrivers found in '${this.executableDir}'`);
    }

    log.debug(`The following Chromedriver executables were found:`);

    for (const cd of cds) {
      log.debug(`    ${cd.executable} (minimum Chrome version '${cd.minCDVersion ? cd.minCDVersion : 'Unknown'}')`);
    }

    return cds;
  }

  async getChromeVersion() {
    let chromeVersion;

    if (this.adb && (await this.adb.getApiLevel()) >= 24) {
      this.bundleId = CHROME_BUNDLE_ID;
    }

    if (!this.bundleId) {
      this.bundleId = CHROME_BUNDLE_ID;

      for (const bundleId of WEBVIEW_BUNDLE_IDS) {
        chromeVersion = await (0, _utils.getChromeVersion)(this.adb, bundleId);

        if (chromeVersion) {
          this.bundleId = bundleId;
          break;
        }
      }
    }

    if (!chromeVersion) {
      chromeVersion = await (0, _utils.getChromeVersion)(this.adb, this.bundleId);
    }

    return chromeVersion ? _semver.default.coerce(chromeVersion) : null;
  }

  async getCompatibleChromedriver() {
    if (!this.adb) {
      return await (0, _utils.getChromedriverBinaryPath)();
    }

    const mapping = await this.getMapping();
    const cds = await this.getChromedrivers(mapping);
    const chromeVersion = await this.getChromeVersion();

    if (!chromeVersion) {
      let cd = cds[0];
      log.warn(`Unable to discover Chrome version. Using Chromedriver ${cd.version} at '${cd.executable}'`);
      return cd.executable;
    }

    log.debug(`Found Chrome bundle '${this.bundleId}' version '${chromeVersion}'`);

    if (_semver.default.gt(chromeVersion, _lodash.default.values(mapping)[0]) && !_lodash.default.isUndefined(cds[0]) && _lodash.default.isUndefined(cds[0].minCDVersion)) {
      let cd = cds[0];
      log.warn(`No known Chromedriver available to automate Chrome version '${chromeVersion}'.\n` + `Using Chromedriver version '${cd.version}', which has not been tested with Appium.`);
      return cd.executable;
    }

    const workingCds = cds.filter(cd => {
      return !_lodash.default.isUndefined(cd.minCDVersion) && _semver.default.gte(chromeVersion, cd.minCDVersion);
    });

    if (_lodash.default.isEmpty(workingCds)) {
      log.errorAndThrow(`No Chromedriver found that can automate Chrome '${chromeVersion}'. ` + `See ${CHROMEDRIVER_TUTORIAL} for more details.`);
    }

    const binPath = workingCds[0].executable;
    log.debug(`Found ${workingCds.length} Chromedriver executable${workingCds.length === 1 ? '' : 's'} ` + `capable of automating Chrome '${chromeVersion}'.\n` + `Choosing the most recent, '${binPath}'.`);
    log.debug('If a specific version is required, specify it with the `chromedriverExecutable`' + 'desired capability.');
    return binPath;
  }

  async initChromedriverPath() {
    if (this.executableVerified) return;

    if (!this.chromedriver) {
      this.chromedriver = this.useSystemExecutable ? await (0, _utils.getChromedriverBinaryPath)() : await this.getCompatibleChromedriver();
    }

    if (!(await _appiumSupport.fs.exists(this.chromedriver))) {
      throw new Error(`Trying to use a chromedriver binary at the path ` + `${this.chromedriver}, but it doesn't exist!`);
    }

    this.executableVerified = true;
    log.info(`Set chromedriver binary as: ${this.chromedriver}`);
  }

  async start(caps, emitStartingState = true) {
    this.capabilities = caps;

    if (emitStartingState) {
      this.changeState(Chromedriver.STATE_STARTING);
    }

    let args = ["--url-base=wd/hub", `--port=${this.proxyPort}`];

    if (this.adb && this.adb.adbPort) {
      args = args.concat([`--adb-port=${this.adb.adbPort}`]);
    }

    if (this.cmdArgs) {
      args = args.concat(this.cmdArgs);
    }

    if (this.logPath) {
      args = args.concat([`--log-path=${this.logPath}`]);
    }

    if (this.disableBuildCheck) {
      args = args.concat(['--disable-build-check']);
    }

    args = args.concat(['--verbose']);

    const startDetector = stdout => {
      return stdout.indexOf('Starting ') === 0;
    };

    let processIsAlive = false;
    let webviewVersion;

    try {
      await this.initChromedriverPath();
      await this.killAll();
      this.proc = new _teen_process.SubProcess(this.chromedriver, args);
      processIsAlive = true;
      this.proc.on('output', (stdout, stderr) => {
        const out = stdout + stderr;
        let match = /"Browser": "(.*)"/.exec(out);

        if (match) {
          webviewVersion = match[1];
          log.debug(`Webview version: '${webviewVersion}'`);
        }

        match = /Starting ChromeDriver ([.\d]+)/.exec(out);

        if (match) {
          log.debug(`Chromedriver version: '${match[1]}'`);
        }

        if (this.verbose) {
          for (let line of (stdout || '').trim().split('\n')) {
            if (!line.trim().length) continue;
            log.debug(`[STDOUT] ${line}`);
          }

          for (let line of (stderr || '').trim().split('\n')) {
            if (!line.trim().length) continue;
            log.error(`[STDERR] ${line}`);
          }
        }
      });
      this.proc.on('exit', (code, signal) => {
        processIsAlive = false;

        if (this.state !== Chromedriver.STATE_STOPPED && this.state !== Chromedriver.STATE_STOPPING && this.state !== Chromedriver.STATE_RESTARTING) {
          let msg = `Chromedriver exited unexpectedly with code ${code}, ` + `signal ${signal}`;
          log.error(msg);
          this.changeState(Chromedriver.STATE_STOPPED);
        }
      });
      log.info(`Spawning chromedriver with: ${this.chromedriver} ` + `${args.join(' ')}`);
      await this.proc.start(startDetector);
      await this.waitForOnline();
      await this.startSession();
    } catch (e) {
      this.emit(Chromedriver.EVENT_ERROR, e);

      if (processIsAlive) {
        await this.proc.stop();
      }

      let message = '';

      if (e.message.includes('Chrome version must be')) {
        message += 'Unable to automate Chrome version because it is too old for this version of Chromedriver.\n';

        if (webviewVersion) {
          message += `Chrome version on the device: ${webviewVersion}\n`;
        }

        message += `Visit '${CHROMEDRIVER_TUTORIAL}' to troubleshoot the problem.\n`;
      }

      message += e.message;
      log.errorAndThrow(message);
    }
  }

  sessionId() {
    if (this.state !== Chromedriver.STATE_ONLINE) {
      return null;
    }

    return this.jwproxy.sessionId;
  }

  async restart() {
    log.info("Restarting chromedriver");

    if (this.state !== Chromedriver.STATE_ONLINE) {
      throw new Error("Can't restart when we're not online");
    }

    this.changeState(Chromedriver.STATE_RESTARTING);
    await this.stop(false);
    await this.start(this.capabilities, false);
  }

  async waitForOnline() {
    let chromedriverStopped = false;
    await (0, _asyncbox.retryInterval)(20, 200, async () => {
      if (this.state === Chromedriver.STATE_STOPPED) {
        chromedriverStopped = true;
        return;
      }

      await this.getStatus();
    });

    if (chromedriverStopped) {
      throw new Error('ChromeDriver crashed during startup.');
    }
  }

  async getStatus() {
    return await this.jwproxy.command('/status', 'GET');
  }

  async startSession() {
    await (0, _asyncbox.retryInterval)(4, 200, async () => {
      try {
        let res = await this.jwproxy.command('/session', 'POST', {
          desiredCapabilities: this.capabilities
        });

        if (res.status) {
          throw new Error(res.value.message);
        }
      } catch (err) {
        log.errorAndThrow(`Failed to start Chromedriver session: ${err.message}`);
      }
    });
    this.changeState(Chromedriver.STATE_ONLINE);
  }

  async stop(emitStates = true) {
    if (emitStates) {
      this.changeState(Chromedriver.STATE_STOPPING);
    }

    try {
      await this.jwproxy.command('', 'DELETE');
      await this.proc.stop('SIGTERM', 20000);

      if (emitStates) {
        this.changeState(Chromedriver.STATE_STOPPED);
      }
    } catch (e) {
      log.error(e);
    }
  }

  changeState(state) {
    this.state = state;
    log.debug(`Changed state to '${state}'`);
    this.emit(Chromedriver.EVENT_CHANGED, {
      state
    });
  }

  async sendCommand(url, method, body) {
    return await this.jwproxy.command(url, method, body);
  }

  async proxyReq(req, res) {
    return await this.jwproxy.proxyReqRes(req, res);
  }

  async killAll() {
    let cmd;

    if (_appiumSupport.system.isWindows()) {
      cmd = "FOR /F \"usebackq tokens=5\" %a in (`netstat -nao ^| " + "findstr /R /C:\"" + this.proxyPort + " \"`) do (" + "FOR /F \"usebackq\" %b in (`TASKLIST /FI \"PID eq %a\" ^| " + "findstr /I chromedriver.exe`) do (IF NOT %b==\"\" TASKKILL " + "/F /PID %a))";
    } else {
      cmd = `pkill -15 -f "${this.chromedriver}.*--port=${this.proxyPort}"`;
    }

    log.debug(`Killing any old chromedrivers, running: ${cmd}`);

    try {
      await _bluebird.default.promisify(_child_process.default.exec)(cmd);
      log.debug("Successfully cleaned up old chromedrivers");
    } catch (err) {
      log.warn("No old chromedrivers seemed to exist");
    }

    if (this.adb) {
      log.debug(`Cleaning any old adb forwarded port socket connections`);

      try {
        for (let conn of await this.adb.getForwardList()) {
          if (conn.indexOf('webview_devtools') !== -1) {
            let params = conn.split(/\s+/);

            if (params.length > 1) {
              await this.adb.removePortForward(params[1].replace(/[\D]*/, ''));
            }
          }
        }
      } catch (err) {
        log.warn(`Unable to clean forwarded ports. Error: '${err.message}'. Continuing.`);
      }
    }
  }

  async hasWorkingWebview() {
    try {
      await this.jwproxy.command('/url', 'GET');
      return true;
    } catch (e) {
      return false;
    }
  }

}

exports.Chromedriver = Chromedriver;
Chromedriver.EVENT_ERROR = 'chromedriver_error';
Chromedriver.EVENT_CHANGED = 'stateChanged';
Chromedriver.STATE_STOPPED = 'stopped';
Chromedriver.STATE_STARTING = 'starting';
Chromedriver.STATE_ONLINE = 'online';
Chromedriver.STATE_STOPPING = 'stopping';
Chromedriver.STATE_RESTARTING = 'restarting';
var _default = Chromedriver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jaHJvbWVkcml2ZXIuanMiXSwibmFtZXMiOlsibG9nIiwibG9nZ2VyIiwiZ2V0TG9nZ2VyIiwiREVGQVVMVF9IT1NUIiwiREVGQVVMVF9QT1JUIiwiQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HIiwiQ0hST01FX0JVTkRMRV9JRCIsIldFQlZJRVdfQlVORExFX0lEUyIsIkNIUk9NRURSSVZFUl9UVVRPUklBTCIsIkNEX1ZFUiIsInByb2Nlc3MiLCJlbnYiLCJucG1fY29uZmlnX2Nocm9tZWRyaXZlcl92ZXJzaW9uIiwiQ0hST01FRFJJVkVSX1ZFUlNJT04iLCJnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyIiwiQ0RfVkVSU0lPTl9USU1FT1VUIiwibWFwcGluZyIsIl8iLCJpc0VtcHR5IiwiRXJyb3IiLCJrZXlzIiwibWFwIiwic2VtdmVyIiwiY29lcmNlIiwic29ydCIsInJjb21wYXJlIiwidiIsIm1ham9yIiwibWlub3IiLCJDaHJvbWVkcml2ZXIiLCJldmVudHMiLCJFdmVudEVtaXR0ZXIiLCJjb25zdHJ1Y3RvciIsImFyZ3MiLCJob3N0IiwicG9ydCIsInVzZVN5c3RlbUV4ZWN1dGFibGUiLCJleGVjdXRhYmxlIiwiZXhlY3V0YWJsZURpciIsImJ1bmRsZUlkIiwibWFwcGluZ1BhdGgiLCJjbWRBcmdzIiwiYWRiIiwidmVyYm9zZSIsImxvZ1BhdGgiLCJkaXNhYmxlQnVpbGRDaGVjayIsInByb3h5SG9zdCIsInByb3h5UG9ydCIsInByb2MiLCJjaHJvbWVkcml2ZXIiLCJleGVjdXRhYmxlVmVyaWZpZWQiLCJzdGF0ZSIsIlNUQVRFX1NUT1BQRUQiLCJqd3Byb3h5IiwiSldQcm94eSIsInNlcnZlciIsImdldE1hcHBpbmciLCJkZWJ1ZyIsImZzIiwiZXhpc3RzIiwid2FybiIsIkpTT04iLCJwYXJzZSIsInJlYWRGaWxlIiwiZXJyIiwiZXJyb3IiLCJtZXNzYWdlIiwiY2RWZXJzaW9uIiwiY2hyb21lVmVyc2lvbiIsInRvUGFpcnMiLCJnZXRDaHJvbWVkcml2ZXJzIiwiZXhlY3V0YWJsZXMiLCJnbG9iIiwibGVuZ3RoIiwiY2RzIiwibG9nRXJyb3IiLCJzdGRvdXQiLCJzdGRlcnIiLCJlcnJNc2ciLCJwYXRoIiwiYmFzZW5hbWUiLCJ0aW1lb3V0IiwiaW5jbHVkZXMiLCJtYXRjaCIsImV4ZWMiLCJ2ZXJzaW9uT2JqIiwidmVyc2lvbiIsIm1pbkNEVmVyc2lvbiIsImZpbHRlciIsImNkIiwiYSIsImIiLCJndGUiLCJlcnJvckFuZFRocm93IiwiZ2V0Q2hyb21lVmVyc2lvbiIsImdldEFwaUxldmVsIiwiZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlciIsImd0IiwidmFsdWVzIiwiaXNVbmRlZmluZWQiLCJ3b3JraW5nQ2RzIiwiYmluUGF0aCIsImluaXRDaHJvbWVkcml2ZXJQYXRoIiwiaW5mbyIsInN0YXJ0IiwiY2FwcyIsImVtaXRTdGFydGluZ1N0YXRlIiwiY2FwYWJpbGl0aWVzIiwiY2hhbmdlU3RhdGUiLCJTVEFURV9TVEFSVElORyIsImFkYlBvcnQiLCJjb25jYXQiLCJzdGFydERldGVjdG9yIiwiaW5kZXhPZiIsInByb2Nlc3NJc0FsaXZlIiwid2Vidmlld1ZlcnNpb24iLCJraWxsQWxsIiwiU3ViUHJvY2VzcyIsIm9uIiwib3V0IiwibGluZSIsInRyaW0iLCJzcGxpdCIsImNvZGUiLCJzaWduYWwiLCJTVEFURV9TVE9QUElORyIsIlNUQVRFX1JFU1RBUlRJTkciLCJtc2ciLCJqb2luIiwid2FpdEZvck9ubGluZSIsInN0YXJ0U2Vzc2lvbiIsImUiLCJlbWl0IiwiRVZFTlRfRVJST1IiLCJzdG9wIiwic2Vzc2lvbklkIiwiU1RBVEVfT05MSU5FIiwicmVzdGFydCIsImNocm9tZWRyaXZlclN0b3BwZWQiLCJnZXRTdGF0dXMiLCJjb21tYW5kIiwicmVzIiwiZGVzaXJlZENhcGFiaWxpdGllcyIsInN0YXR1cyIsInZhbHVlIiwiZW1pdFN0YXRlcyIsIkVWRU5UX0NIQU5HRUQiLCJzZW5kQ29tbWFuZCIsInVybCIsIm1ldGhvZCIsImJvZHkiLCJwcm94eVJlcSIsInJlcSIsInByb3h5UmVxUmVzIiwiY21kIiwic3lzdGVtIiwiaXNXaW5kb3dzIiwiQiIsInByb21pc2lmeSIsImNwIiwiY29ubiIsImdldEZvcndhcmRMaXN0IiwicGFyYW1zIiwicmVtb3ZlUG9ydEZvcndhcmQiLCJyZXBsYWNlIiwiaGFzV29ya2luZ1dlYnZpZXciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBLE1BQU1BLEdBQUcsR0FBR0Msc0JBQU9DLFNBQVAsQ0FBaUIsY0FBakIsQ0FBWjs7QUFFQSxNQUFNQyxZQUFZLEdBQUcsV0FBckI7QUFDQSxNQUFNQyxZQUFZLEdBQUcsSUFBckI7QUFDQSxNQUFNQywyQkFBMkIsR0FBRztBQUVsQyxVQUFRLFdBRjBCO0FBR2xDLFVBQVEsV0FIMEI7QUFJbEMsVUFBUSxXQUowQjtBQUtsQyxVQUFRLFdBTDBCO0FBTWxDLFVBQVEsV0FOMEI7QUFPbEMsVUFBUSxXQVAwQjtBQVFsQyxVQUFRLFdBUjBCO0FBU2xDLFVBQVEsV0FUMEI7QUFVbEMsVUFBUSxXQVYwQjtBQVdsQyxVQUFRLFdBWDBCO0FBWWxDLFVBQVEsV0FaMEI7QUFhbEMsVUFBUSxXQWIwQjtBQWNsQyxVQUFRLFdBZDBCO0FBZWxDLFVBQVEsV0FmMEI7QUFnQmxDLFVBQVEsV0FoQjBCO0FBaUJsQyxVQUFRLFdBakIwQjtBQWtCbEMsVUFBUSxXQWxCMEI7QUFtQmxDLFVBQVEsV0FuQjBCO0FBb0JsQyxVQUFRLFdBcEIwQjtBQXFCbEMsVUFBUSxXQXJCMEI7QUFzQmxDLFVBQVEsV0F0QjBCO0FBdUJsQyxVQUFRLFdBdkIwQjtBQXdCbEMsVUFBUSxXQXhCMEI7QUF5QmxDLFVBQVEsV0F6QjBCO0FBMEJsQyxVQUFRLFdBMUIwQjtBQTJCbEMsVUFBUSxXQTNCMEI7QUE0QmxDLFVBQVEsV0E1QjBCO0FBNkJsQyxVQUFRLFdBN0IwQjtBQThCbEMsVUFBUSxX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cm9tICdldmVudHMnO1xuaW1wb3J0IHsgSldQcm94eSB9IGZyb20gJ2FwcGl1bS1iYXNlLWRyaXZlcic7XG5pbXBvcnQgY3AgZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgeyBzeXN0ZW0sIGZzLCBsb2dnZXIgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgeyByZXRyeUludGVydmFsLCBhc3luY21hcCB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCB7IFN1YlByb2Nlc3MsIGV4ZWMgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IHsgZ2V0Q2hyb21lVmVyc2lvbiwgZ2V0Q2hyb21lZHJpdmVyRGlyLCBnZXRDaHJvbWVkcml2ZXJCaW5hcnlQYXRoIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgc2VtdmVyIGZyb20gJ3NlbXZlcic7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cblxuY29uc3QgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignQ2hyb21lZHJpdmVyJyk7XG5cbmNvbnN0IERFRkFVTFRfSE9TVCA9ICcxMjcuMC4wLjEnO1xuY29uc3QgREVGQVVMVF9QT1JUID0gOTUxNTtcbmNvbnN0IENIUk9NRURSSVZFUl9DSFJPTUVfTUFQUElORyA9IHtcbiAgLy8gQ2hyb21lZHJpdmVyIHZlcnNpb246IG1pbnVtdW0gQ2hyb21lIHZlcnNpb25cbiAgJzIuNDQnOiAnNjkuMC4zNDk3JyxcbiAgJzIuNDMnOiAnNjkuMC4zNDk3JyxcbiAgJzIuNDInOiAnNjguMC4zNDQwJyxcbiAgJzIuNDEnOiAnNjcuMC4zMzk2JyxcbiAgJzIuNDAnOiAnNjYuMC4zMzU5JyxcbiAgJzIuMzknOiAnNjYuMC4zMzU5JyxcbiAgJzIuMzgnOiAnNjUuMC4zMzI1JyxcbiAgJzIuMzcnOiAnNjQuMC4zMjgyJyxcbiAgJzIuMzYnOiAnNjMuMC4zMjM5JyxcbiAgJzIuMzUnOiAnNjIuMC4zMjAyJyxcbiAgJzIuMzQnOiAnNjEuMC4zMTYzJyxcbiAgJzIuMzMnOiAnNjAuMC4zMTEyJyxcbiAgJzIuMzInOiAnNTkuMC4zMDcxJyxcbiAgJzIuMzEnOiAnNTguMC4zMDI5JyxcbiAgJzIuMzAnOiAnNTguMC4zMDI5JyxcbiAgJzIuMjknOiAnNTcuMC4yOTg3JyxcbiAgJzIuMjgnOiAnNTUuMC4yODgzJyxcbiAgJzIuMjcnOiAnNTQuMC4yODQwJyxcbiAgJzIuMjYnOiAnNTMuMC4yNzg1JyxcbiAgJzIuMjUnOiAnNTMuMC4yNzg1JyxcbiAgJzIuMjQnOiAnNTIuMC4yNzQzJyxcbiAgJzIuMjMnOiAnNTEuMC4yNzA0JyxcbiAgJzIuMjInOiAnNDkuMC4yNjIzJyxcbiAgJzIuMjEnOiAnNDYuMC4yNDkwJyxcbiAgJzIuMjAnOiAnNDMuMC4yMzU3JyxcbiAgJzIuMTknOiAnNDMuMC4yMzU3JyxcbiAgJzIuMTgnOiAnNDMuMC4yMzU3JyxcbiAgJzIuMTcnOiAnNDIuMC4yMzExJyxcbiAgJzIuMTYnOiAnNDIuMC4yMzExJyxcbiAgJzIuMTUnOiAnNDAuMC4yMjE0JyxcbiAgJzIuMTQnOiAnMzkuMC4yMTcxJyxcbiAgJzIuMTMnOiAnMzguMC4yMTI1JyxcbiAgJzIuMTInOiAnMzYuMC4xOTg1JyxcbiAgJzIuMTEnOiAnMzYuMC4xOTg1JyxcbiAgJzIuMTAnOiAnMzMuMC4xNzUxJyxcbiAgJzIuOSc6ICczMS4wLjE2NTAnLFxuICAnMi44JzogJzMwLjAuMTU3MycsXG4gICcyLjcnOiAnMzAuMC4xNTczJyxcbiAgJzIuNic6ICcyOS4wLjE1NDUnLFxuICAnMi41JzogJzI5LjAuMTU0NScsXG4gICcyLjQnOiAnMjkuMC4xNTQ1JyxcbiAgJzIuMyc6ICcyOC4wLjE1MDAnLFxuICAnMi4yJzogJzI3LjAuMTQ1MycsXG4gICcyLjEnOiAnMjcuMC4xNDUzJyxcbiAgJzIuMCc6ICcyNy4wLjE0NTMnLFxufTtcbmNvbnN0IENIUk9NRV9CVU5ETEVfSUQgPSAnY29tLmFuZHJvaWQuY2hyb21lJztcbmNvbnN0IFdFQlZJRVdfQlVORExFX0lEUyA9IFtcbiAgJ2NvbS5nb29nbGUuYW5kcm9pZC53ZWJ2aWV3JyxcbiAgJ2NvbS5hbmRyb2lkLndlYnZpZXcnLFxuXTtcbmNvbnN0IENIUk9NRURSSVZFUl9UVVRPUklBTCA9ICdodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9ibG9iL21hc3Rlci9kb2NzL2VuL3dyaXRpbmctcnVubmluZy1hcHBpdW0vd2ViL2Nocm9tZWRyaXZlci5tZCc7XG5cbmNvbnN0IENEX1ZFUiA9IHByb2Nlc3MuZW52Lm5wbV9jb25maWdfY2hyb21lZHJpdmVyX3ZlcnNpb24gfHxcbiAgICAgICAgICAgICAgIHByb2Nlc3MuZW52LkNIUk9NRURSSVZFUl9WRVJTSU9OIHx8XG4gICAgICAgICAgICAgICBnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyKCk7XG5cbmNvbnN0IENEX1ZFUlNJT05fVElNRU9VVCA9IDUwMDA7XG5cbmZ1bmN0aW9uIGdldE1vc3RSZWNlbnRDaHJvbWVkcml2ZXIgKG1hcHBpbmcgPSBDSFJPTUVEUklWRVJfQ0hST01FX01BUFBJTkcpIHtcbiAgaWYgKF8uaXNFbXB0eShtYXBwaW5nKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGdldCBtb3N0IHJlY2VudCBDaHJvbWVkcml2ZXIgZnJvbSBlbXB0eSBtYXBwaW5nJyk7XG4gIH1cbiAgcmV0dXJuIF8ua2V5cyhtYXBwaW5nKVxuICAgIC5tYXAoc2VtdmVyLmNvZXJjZSlcbiAgICAuc29ydChzZW12ZXIucmNvbXBhcmUpXG4gICAgLm1hcCgodikgPT4gYCR7c2VtdmVyLm1ham9yKHYpfS4ke3NlbXZlci5taW5vcih2KX1gKVswXTtcbn1cblxuY2xhc3MgQ2hyb21lZHJpdmVyIGV4dGVuZHMgZXZlbnRzLkV2ZW50RW1pdHRlciB7XG4gIGNvbnN0cnVjdG9yIChhcmdzID0ge30pIHtcbiAgICBzdXBlcigpO1xuXG4gICAgY29uc3Qge1xuICAgICAgaG9zdCA9IERFRkFVTFRfSE9TVCxcbiAgICAgIHBvcnQgPSBERUZBVUxUX1BPUlQsXG4gICAgICB1c2VTeXN0ZW1FeGVjdXRhYmxlID0gZmFsc2UsXG4gICAgICBleGVjdXRhYmxlLFxuICAgICAgZXhlY3V0YWJsZURpciA9IGdldENocm9tZWRyaXZlckRpcigpLFxuICAgICAgYnVuZGxlSWQsXG4gICAgICBtYXBwaW5nUGF0aCxcbiAgICAgIGNtZEFyZ3MsXG4gICAgICBhZGIsXG4gICAgICB2ZXJib3NlLFxuICAgICAgbG9nUGF0aCxcbiAgICAgIGRpc2FibGVCdWlsZENoZWNrLFxuICAgIH0gPSBhcmdzO1xuXG4gICAgdGhpcy5wcm94eUhvc3QgPSBob3N0O1xuICAgIHRoaXMucHJveHlQb3J0ID0gcG9ydDtcbiAgICB0aGlzLmFkYiA9IGFkYjtcbiAgICB0aGlzLmNtZEFyZ3MgPSBjbWRBcmdzO1xuICAgIHRoaXMucHJvYyA9IG51bGw7XG4gICAgdGhpcy51c2VTeXN0ZW1FeGVjdXRhYmxlID0gdXNlU3lzdGVtRXhlY3V0YWJsZTtcbiAgICB0aGlzLmNocm9tZWRyaXZlciA9IGV4ZWN1dGFibGU7XG4gICAgdGhpcy5leGVjdXRhYmxlRGlyID0gZXhlY3V0YWJsZURpcjtcbiAgICB0aGlzLm1hcHBpbmdQYXRoID0gbWFwcGluZ1BhdGg7XG4gICAgdGhpcy5idW5kbGVJZCA9IGJ1bmRsZUlkO1xuICAgIHRoaXMuZXhlY3V0YWJsZVZlcmlmaWVkID0gZmFsc2U7XG4gICAgdGhpcy5zdGF0ZSA9IENocm9tZWRyaXZlci5TVEFURV9TVE9QUEVEO1xuICAgIHRoaXMuandwcm94eSA9IG5ldyBKV1Byb3h5KHtzZXJ2ZXI6IHRoaXMucHJveHlIb3N0LCBwb3J0OiB0aGlzLnByb3h5UG9ydH0pO1xuICAgIHRoaXMudmVyYm9zZSA9IHZlcmJvc2U7XG4gICAgdGhpcy5sb2dQYXRoID0gbG9nUGF0aDtcbiAgICB0aGlzLmRpc2FibGVCdWlsZENoZWNrID0gISFkaXNhYmxlQnVpbGRDaGVjaztcbiAgfVxuXG4gIGFzeW5jIGdldE1hcHBpbmcgKCkge1xuICAgIGxldCBtYXBwaW5nID0gQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HO1xuICAgIGlmICh0aGlzLm1hcHBpbmdQYXRoKSB7XG4gICAgICBsb2cuZGVidWcoYEF0dGVtcHRpbmcgdG8gdXNlIENocm9tZWRyaXZlci1DaHJvbWUgbWFwcGluZyBmcm9tICcke3RoaXMubWFwcGluZ1BhdGh9J2ApO1xuICAgICAgaWYgKCFhd2FpdCBmcy5leGlzdHModGhpcy5tYXBwaW5nUGF0aCkpIHtcbiAgICAgICAgbG9nLndhcm4oYE5vIGZpbGUgZm91bmQgYXQgJyR7dGhpcy5tYXBwaW5nUGF0aH0nLiBVc2luZyBkZWZhdWx0IG1hcHBpbmdgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgbWFwcGluZyA9IEpTT04ucGFyc2UoYXdhaXQgZnMucmVhZEZpbGUodGhpcy5tYXBwaW5nUGF0aCkpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBsb2cuZXJyb3IoYEVycm9yIHBhcnNpbmcgbWFwcGluZyBmcm9tICcke3RoaXMubWFwcGluZ1BhdGh9JzogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgICBsb2cud2FybignVXNpbmcgZGVmYXVsdCBtYXBwaW5nJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBtYWtlIHN1cmUgdGhhdCB0aGUgdmFsdWVzIGZvciBtaW5pbXVtIGNocm9tZSB2ZXJzaW9uIGFyZSBzZW12ZXIgY29tcGxpYW50XG4gICAgZm9yIChjb25zdCBbY2RWZXJzaW9uLCBjaHJvbWVWZXJzaW9uXSBvZiBfLnRvUGFpcnMobWFwcGluZykpIHtcbiAgICAgIG1hcHBpbmdbY2RWZXJzaW9uXSA9IHNlbXZlci5jb2VyY2UoY2hyb21lVmVyc2lvbik7XG4gICAgfVxuICAgIHJldHVybiBtYXBwaW5nO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q2hyb21lZHJpdmVycyAobWFwcGluZykge1xuICAgIC8vIGdvIHRocm91Z2ggdGhlIHZlcnNpb25zIGF2YWlsYWJsZVxuICAgIGNvbnN0IGV4ZWN1dGFibGVzID0gYXdhaXQgZnMuZ2xvYihgJHt0aGlzLmV4ZWN1dGFibGVEaXJ9LypgKTtcbiAgICBsb2cuZGVidWcoYEZvdW5kICR7ZXhlY3V0YWJsZXMubGVuZ3RofSBleGVjdXRhYmxlJHtleGVjdXRhYmxlcy5sZW5ndGggPT09IDEgPyAnJyA6ICdzJ30gYCArXG4gICAgICBgaW4gJyR7dGhpcy5leGVjdXRhYmxlRGlyfSdgKTtcbiAgICBjb25zdCBjZHMgPSAoYXdhaXQgYXN5bmNtYXAoZXhlY3V0YWJsZXMsIGFzeW5jIGZ1bmN0aW9uIChleGVjdXRhYmxlKSB7XG4gICAgICBjb25zdCBsb2dFcnJvciA9ICh7bWVzc2FnZSwgc3Rkb3V0ID0gbnVsbCwgc3RkZXJyID0gbnVsbH0pID0+IHtcbiAgICAgICAgbGV0IGVyck1zZyA9IGBDYW5ub3QgcmV0cmlldmUgdmVyc2lvbiBudW1iZXIgZnJvbSAnJHtwYXRoLmJhc2VuYW1lKGV4ZWN1dGFibGUpfScgQ2hyb21lZHJpdmVyIGJpbmFyeS4gYCArXG4gICAgICAgICAgYE1ha2Ugc3VyZSBpdCByZXR1cm5zIGEgdmFsaWQgdmVyc2lvbiBzdHJpbmcgaW4gcmVzcG9uc2UgdG8gJy0tdmVyc2lvbicgY29tbWFuZCBsaW5lIGFyZ3VtZW50LiAke21lc3NhZ2V9YDtcbiAgICAgICAgaWYgKHN0ZG91dCkge1xuICAgICAgICAgIGVyck1zZyArPSBgXFxuU3Rkb3V0OiAke3N0ZG91dH1gO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGRlcnIpIHtcbiAgICAgICAgICBlcnJNc2cgKz0gYFxcblN0ZGVycjogJHtzdGRlcnJ9YDtcbiAgICAgICAgfVxuICAgICAgICBsb2cud2FybihlcnJNc2cpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG5cbiAgICAgIGxldCBzdGRvdXQ7XG4gICAgICBsZXQgc3RkZXJyO1xuICAgICAgdHJ5IHtcbiAgICAgICAgKHtzdGRvdXQsIHN0ZGVycn0gPSBhd2FpdCBleGVjKGV4ZWN1dGFibGUsIFsnLS12ZXJzaW9uJ10sIHtcbiAgICAgICAgICB0aW1lb3V0OiBDRF9WRVJTSU9OX1RJTUVPVVQsXG4gICAgICAgIH0pKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoIShlcnIubWVzc2FnZSB8fCAnJykuaW5jbHVkZXMoJ3RpbWVkIG91dCcpICYmICEoZXJyLnN0ZG91dCB8fCAnJykuaW5jbHVkZXMoJ1N0YXJ0aW5nIENocm9tZURyaXZlcicpKSB7XG4gICAgICAgICAgcmV0dXJuIGxvZ0Vycm9yKGVycik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiB0aGlzIGhhcyB0aW1lZCBvdXQsaXQgaGFzIGFjdHVhbGx5IHN0YXJ0ZWQgQ2hyb21lZHJpdmVyLFxuICAgICAgICAvLyBpbiB3aGljaCBjYXNlIHRoZXJlIHdpbGwgYWxzbyBiZSB0aGUgdmVyc2lvbiBzdHJpbmcgaW4gdGhlIG91dHB1dFxuICAgICAgICBzdGRvdXQgPSBlcnIuc3Rkb3V0O1xuICAgICAgfVxuXG4gICAgICBjb25zdCBtYXRjaCA9IC9DaHJvbWVEcml2ZXJcXHMrXFwoP3Y/KFtcXGQuXSspXFwpPy9pLmV4ZWMoc3Rkb3V0KTsgLy8gaHR0cHM6Ly9yZWdleDEwMS5jb20vci96cGo1d0EvMVxuICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICByZXR1cm4gbG9nRXJyb3Ioe21lc3NhZ2U6ICdDYW5ub3QgcGFyc2UgdGhlIHZlcnNpb24gc3RyaW5nJywgc3Rkb3V0LCBzdGRlcnJ9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHZlcnNpb25PYmogPSBzZW12ZXIuY29lcmNlKG1hdGNoWzFdLCB0cnVlKTtcbiAgICAgIGlmICghdmVyc2lvbk9iaikge1xuICAgICAgICByZXR1cm4gbG9nRXJyb3Ioe21lc3NhZ2U6ICdDYW5ub3QgY29lcmNlIHRoZSB2ZXJzaW9uIG51bWJlcicsIHN0ZG91dCwgc3RkZXJyfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB2ZXJzaW9uID0gYCR7dmVyc2lvbk9iai5tYWpvcn0uJHt2ZXJzaW9uT2JqLm1pbm9yfWA7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBleGVjdXRhYmxlLFxuICAgICAgICB2ZXJzaW9uLFxuICAgICAgICBtaW5DRFZlcnNpb246IG1hcHBpbmdbdmVyc2lvbl0sXG4gICAgICB9O1xuICAgIH0pKVxuICAgICAgLmZpbHRlcigoY2QpID0+ICEhY2QpXG4gICAgICAuc29ydCgoYSwgYikgPT4gc2VtdmVyLmd0ZShzZW12ZXIuY29lcmNlKGIudmVyc2lvbiksIHNlbXZlci5jb2VyY2UoYS52ZXJzaW9uKSkgPyAxIDogLTEpO1xuICAgIGlmIChfLmlzRW1wdHkoY2RzKSkge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coYE5vIENocm9tZWRyaXZlcnMgZm91bmQgaW4gJyR7dGhpcy5leGVjdXRhYmxlRGlyfSdgKTtcbiAgICB9XG4gICAgbG9nLmRlYnVnKGBUaGUgZm9sbG93aW5nIENocm9tZWRyaXZlciBleGVjdXRhYmxlcyB3ZXJlIGZvdW5kOmApO1xuICAgIGZvciAoY29uc3QgY2Qgb2YgY2RzKSB7XG4gICAgICBsb2cuZGVidWcoYCAgICAke2NkLmV4ZWN1dGFibGV9IChtaW5pbXVtIENocm9tZSB2ZXJzaW9uICcke2NkLm1pbkNEVmVyc2lvbiA/IGNkLm1pbkNEVmVyc2lvbiA6ICdVbmtub3duJ30nKWApO1xuICAgIH1cbiAgICByZXR1cm4gY2RzO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q2hyb21lVmVyc2lvbiAoKSB7XG4gICAgbGV0IGNocm9tZVZlcnNpb247XG5cbiAgICAvLyBvbiBBbmRyb2lkIDcrIHdlYnZpZXdzIGFyZSBiYWNrZWQgYnkgdGhlIG1haW4gQ2hyb21lLCBub3QgdGhlIHN5c3RlbSB3ZWJ2aWV3XG4gICAgaWYgKHRoaXMuYWRiICYmIGF3YWl0IHRoaXMuYWRiLmdldEFwaUxldmVsKCkgPj0gMjQpIHtcbiAgICAgIHRoaXMuYnVuZGxlSWQgPSBDSFJPTUVfQlVORExFX0lEO1xuICAgIH1cblxuICAgIC8vIHRyeSBvdXQgd2Vidmlld3Mgd2hlbiBubyBidW5kbGUgaWQgaXMgc2VudCBpblxuICAgIGlmICghdGhpcy5idW5kbGVJZCkge1xuICAgICAgLy8gZGVmYXVsdCB0byB0aGUgZ2VuZXJpYyBDaHJvbWUgYnVuZGxlXG4gICAgICB0aGlzLmJ1bmRsZUlkID0gQ0hST01FX0JVTkRMRV9JRDtcblxuICAgICAgLy8gd2UgaGF2ZSBhIHdlYnZpZXcgb2Ygc29tZSBzb3J0LCBzbyB0cnkgdG8gZmluZCB0aGUgYnVuZGxlIHZlcnNpb25cbiAgICAgIGZvciAoY29uc3QgYnVuZGxlSWQgb2YgV0VCVklFV19CVU5ETEVfSURTKSB7XG4gICAgICAgIGNocm9tZVZlcnNpb24gPSBhd2FpdCBnZXRDaHJvbWVWZXJzaW9uKHRoaXMuYWRiLCBidW5kbGVJZCk7XG4gICAgICAgIGlmIChjaHJvbWVWZXJzaW9uKSB7XG4gICAgICAgICAgdGhpcy5idW5kbGVJZCA9IGJ1bmRsZUlkO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gaWYgd2UgZG8gbm90IGhhdmUgYSBjaHJvbWUgdmVyc2lvbiwgaXQgbXVzdCBub3QgYmUgYSB3ZWJ2aWV3XG4gICAgaWYgKCFjaHJvbWVWZXJzaW9uKSB7XG4gICAgICBjaHJvbWVWZXJzaW9uID0gYXdhaXQgZ2V0Q2hyb21lVmVyc2lvbih0aGlzLmFkYiwgdGhpcy5idW5kbGVJZCk7XG4gICAgfVxuXG4gICAgLy8gbWFrZSBzdXJlIGl0IGlzIHNlbXZlciwgc28gbGF0ZXIgY2hlY2tzIHdvbid0IGZhaWxcbiAgICByZXR1cm4gY2hyb21lVmVyc2lvbiA/IHNlbXZlci5jb2VyY2UoY2hyb21lVmVyc2lvbikgOiBudWxsO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlciAoKSB7XG4gICAgaWYgKCF0aGlzLmFkYikge1xuICAgICAgcmV0dXJuIGF3YWl0IGdldENocm9tZWRyaXZlckJpbmFyeVBhdGgoKTtcbiAgICB9XG5cbiAgICBjb25zdCBtYXBwaW5nID0gYXdhaXQgdGhpcy5nZXRNYXBwaW5nKCk7XG4gICAgY29uc3QgY2RzID0gYXdhaXQgdGhpcy5nZXRDaHJvbWVkcml2ZXJzKG1hcHBpbmcpO1xuXG4gICAgY29uc3QgY2hyb21lVmVyc2lvbiA9IGF3YWl0IHRoaXMuZ2V0Q2hyb21lVmVyc2lvbigpO1xuXG4gICAgaWYgKCFjaHJvbWVWZXJzaW9uKSB7XG4gICAgICAvLyB1bmFibGUgdG8gZ2V0IHRoZSBjaHJvbWUgdmVyc2lvblxuICAgICAgbGV0IGNkID0gY2RzWzBdO1xuICAgICAgbG9nLndhcm4oYFVuYWJsZSB0byBkaXNjb3ZlciBDaHJvbWUgdmVyc2lvbi4gVXNpbmcgQ2hyb21lZHJpdmVyICR7Y2QudmVyc2lvbn0gYXQgJyR7Y2QuZXhlY3V0YWJsZX0nYCk7XG4gICAgICByZXR1cm4gY2QuZXhlY3V0YWJsZTtcbiAgICB9XG5cbiAgICBsb2cuZGVidWcoYEZvdW5kIENocm9tZSBidW5kbGUgJyR7dGhpcy5idW5kbGVJZH0nIHZlcnNpb24gJyR7Y2hyb21lVmVyc2lvbn0nYCk7XG5cbiAgICBpZiAoc2VtdmVyLmd0KGNocm9tZVZlcnNpb24sIF8udmFsdWVzKG1hcHBpbmcpWzBdKSAmJlxuICAgICAgICAhXy5pc1VuZGVmaW5lZChjZHNbMF0pICYmIF8uaXNVbmRlZmluZWQoY2RzWzBdLm1pbkNEVmVyc2lvbikpIHtcbiAgICAgIC8vIHRoaXMgaXMgYSBjaHJvbWUgYWJvdmUgdGhlIGxhdGVzdCB2ZXJzaW9uIHdlIGtub3cgYWJvdXQsXG4gICAgICAvLyBhbmQgd2UgaGF2ZSBhIGNocm9tZWRyaXZlciB0aGF0IGlzIGJleW9uZCB3aGF0IHdlIGtub3csXG4gICAgICAvLyBzbyB1c2UgdGhlIG1vc3QgcmVjZW50IGNocm9tZWRyaXZlciB0aGF0IHdlIGZvdW5kXG4gICAgICBsZXQgY2QgPSBjZHNbMF07XG4gICAgICBsb2cud2FybihgTm8ga25vd24gQ2hyb21lZHJpdmVyIGF2YWlsYWJsZSB0byBhdXRvbWF0ZSBDaHJvbWUgdmVyc2lvbiAnJHtjaHJvbWVWZXJzaW9ufScuXFxuYCArXG4gICAgICAgICAgICAgICBgVXNpbmcgQ2hyb21lZHJpdmVyIHZlcnNpb24gJyR7Y2QudmVyc2lvbn0nLCB3aGljaCBoYXMgbm90IGJlZW4gdGVzdGVkIHdpdGggQXBwaXVtLmApO1xuICAgICAgcmV0dXJuIGNkLmV4ZWN1dGFibGU7XG4gICAgfVxuXG4gICAgY29uc3Qgd29ya2luZ0NkcyA9IGNkcy5maWx0ZXIoKGNkKSA9PiB7XG4gICAgICByZXR1cm4gIV8uaXNVbmRlZmluZWQoY2QubWluQ0RWZXJzaW9uKSAmJiBzZW12ZXIuZ3RlKGNocm9tZVZlcnNpb24sIGNkLm1pbkNEVmVyc2lvbik7XG4gICAgfSk7XG5cbiAgICBpZiAoXy5pc0VtcHR5KHdvcmtpbmdDZHMpKSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgTm8gQ2hyb21lZHJpdmVyIGZvdW5kIHRoYXQgY2FuIGF1dG9tYXRlIENocm9tZSAnJHtjaHJvbWVWZXJzaW9ufScuIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgYFNlZSAke0NIUk9NRURSSVZFUl9UVVRPUklBTH0gZm9yIG1vcmUgZGV0YWlscy5gKTtcbiAgICB9XG5cbiAgICBjb25zdCBiaW5QYXRoID0gd29ya2luZ0Nkc1swXS5leGVjdXRhYmxlO1xuICAgIGxvZy5kZWJ1ZyhgRm91bmQgJHt3b3JraW5nQ2RzLmxlbmd0aH0gQ2hyb21lZHJpdmVyIGV4ZWN1dGFibGUke3dvcmtpbmdDZHMubGVuZ3RoID09PSAxID8gJycgOiAncyd9IGAgK1xuICAgICAgICAgICAgICBgY2FwYWJsZSBvZiBhdXRvbWF0aW5nIENocm9tZSAnJHtjaHJvbWVWZXJzaW9ufScuXFxuYCArXG4gICAgICAgICAgICAgIGBDaG9vc2luZyB0aGUgbW9zdCByZWNlbnQsICcke2JpblBhdGh9Jy5gKTtcbiAgICBsb2cuZGVidWcoJ0lmIGEgc3BlY2lmaWMgdmVyc2lvbiBpcyByZXF1aXJlZCwgc3BlY2lmeSBpdCB3aXRoIHRoZSBgY2hyb21lZHJpdmVyRXhlY3V0YWJsZWAnICtcbiAgICAgICAgICAgICAgJ2Rlc2lyZWQgY2FwYWJpbGl0eS4nKTtcbiAgICByZXR1cm4gYmluUGF0aDtcbiAgfVxuXG4gIGFzeW5jIGluaXRDaHJvbWVkcml2ZXJQYXRoICgpIHtcbiAgICBpZiAodGhpcy5leGVjdXRhYmxlVmVyaWZpZWQpIHJldHVybjsgLy9lc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG5cbiAgICAvLyB0aGUgZXhlY3V0YWJsZSBtaWdodCBiZSBzZXQgKGlmIHBhc3NlZCBpbilcbiAgICAvLyBvciB3ZSBtaWdodCB3YW50IHRvIHVzZSB0aGUgYmFzaWMgb25lIGluc3RhbGxlZCB3aXRoIHRoaXMgZHJpdmVyXG4gICAgLy8gb3Igd2Ugd2FudCB0byBmaWd1cmUgb3V0IHRoZSBiZXN0IG9uZVxuICAgIGlmICghdGhpcy5jaHJvbWVkcml2ZXIpIHtcbiAgICAgIHRoaXMuY2hyb21lZHJpdmVyID0gdGhpcy51c2VTeXN0ZW1FeGVjdXRhYmxlXG4gICAgICAgID8gYXdhaXQgZ2V0Q2hyb21lZHJpdmVyQmluYXJ5UGF0aCgpXG4gICAgICAgIDogYXdhaXQgdGhpcy5nZXRDb21wYXRpYmxlQ2hyb21lZHJpdmVyKCk7XG4gICAgfVxuXG4gICAgaWYgKCFhd2FpdCBmcy5leGlzdHModGhpcy5jaHJvbWVkcml2ZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFRyeWluZyB0byB1c2UgYSBjaHJvbWVkcml2ZXIgYmluYXJ5IGF0IHRoZSBwYXRoIGAgK1xuICAgICAgICAgICAgICAgICAgICAgIGAke3RoaXMuY2hyb21lZHJpdmVyfSwgYnV0IGl0IGRvZXNuJ3QgZXhpc3QhYCk7XG4gICAgfVxuICAgIHRoaXMuZXhlY3V0YWJsZVZlcmlmaWVkID0gdHJ1ZTtcbiAgICBsb2cuaW5mbyhgU2V0IGNocm9tZWRyaXZlciBiaW5hcnkgYXM6ICR7dGhpcy5jaHJvbWVkcml2ZXJ9YCk7XG4gIH1cblxuICBhc3luYyBzdGFydCAoY2FwcywgZW1pdFN0YXJ0aW5nU3RhdGUgPSB0cnVlKSB7XG4gICAgdGhpcy5jYXBhYmlsaXRpZXMgPSBjYXBzO1xuICAgIGlmIChlbWl0U3RhcnRpbmdTdGF0ZSkge1xuICAgICAgdGhpcy5jaGFuZ2VTdGF0ZShDaHJvbWVkcml2ZXIuU1RBVEVfU1RBUlRJTkcpO1xuICAgIH1cblxuICAgIGxldCBhcmdzID0gW1wiLS11cmwtYmFzZT13ZC9odWJcIiwgYC0tcG9ydD0ke3RoaXMucHJveHlQb3J0fWBdO1xuICAgIGlmICh0aGlzLmFkYiAmJiB0aGlzLmFkYi5hZGJQb3J0KSB7XG4gICAgICBhcmdzID0gYXJncy5jb25jYXQoW2AtLWFkYi1wb3J0PSR7dGhpcy5hZGIuYWRiUG9ydH1gXSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmNtZEFyZ3MpIHtcbiAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdCh0aGlzLmNtZEFyZ3MpO1xuICAgIH1cbiAgICBpZiAodGhpcy5sb2dQYXRoKSB7XG4gICAgICBhcmdzID0gYXJncy5jb25jYXQoW2AtLWxvZy1wYXRoPSR7dGhpcy5sb2dQYXRofWBdKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZGlzYWJsZUJ1aWxkQ2hlY2spIHtcbiAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChbJy0tZGlzYWJsZS1idWlsZC1jaGVjayddKTtcbiAgICB9XG4gICAgYXJncyA9IGFyZ3MuY29uY2F0KFsnLS12ZXJib3NlJ10pO1xuICAgIC8vIHdoYXQgYXJlIHRoZSBwcm9jZXNzIHN0ZG91dC9zdGRlcnIgY29uZGl0aW9ucyB3aGVyZWluIHdlIGtub3cgdGhhdFxuICAgIC8vIHRoZSBwcm9jZXNzIGhhcyBzdGFydGVkIHRvIG91ciBzYXRpc2ZhY3Rpb24/XG4gICAgY29uc3Qgc3RhcnREZXRlY3RvciA9IChzdGRvdXQpID0+IHtcbiAgICAgIHJldHVybiBzdGRvdXQuaW5kZXhPZignU3RhcnRpbmcgJykgPT09IDA7XG4gICAgfTtcblxuICAgIGxldCBwcm9jZXNzSXNBbGl2ZSA9IGZhbHNlO1xuICAgIGxldCB3ZWJ2aWV3VmVyc2lvbjtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5pbml0Q2hyb21lZHJpdmVyUGF0aCgpO1xuICAgICAgYXdhaXQgdGhpcy5raWxsQWxsKCk7XG5cbiAgICAgIC8vIHNldCB1cCBvdXIgc3VicHJvY2VzcyBvYmplY3RcbiAgICAgIHRoaXMucHJvYyA9IG5ldyBTdWJQcm9jZXNzKHRoaXMuY2hyb21lZHJpdmVyLCBhcmdzKTtcbiAgICAgIHByb2Nlc3NJc0FsaXZlID0gdHJ1ZTtcblxuICAgICAgLy8gaGFuZGxlIGxvZyBvdXRwdXRcbiAgICAgIHRoaXMucHJvYy5vbignb3V0cHV0JywgKHN0ZG91dCwgc3RkZXJyKSA9PiB7XG4gICAgICAgIC8vIGlmIHRoZSBjZCBvdXRwdXQgaXMgbm90IHByaW50ZWQsIGZpbmQgdGhlIGNocm9tZSB2ZXJzaW9uIGFuZCBwcmludFxuICAgICAgICAvLyB3aWxsIGdldCBhIHJlc3BvbnNlIGxpa2VcbiAgICAgICAgLy8gICBEZXZUb29scyByZXNwb25zZToge1xuICAgICAgICAvLyAgICAgIFwiQW5kcm9pZC1QYWNrYWdlXCI6IFwiaW8uYXBwaXVtLnNhbXBsZWFwcFwiLFxuICAgICAgICAvLyAgICAgIFwiQnJvd3NlclwiOiBcIkNocm9tZS81NS4wLjI4ODMuOTFcIixcbiAgICAgICAgLy8gICAgICBcIlByb3RvY29sLVZlcnNpb25cIjogXCIxLjJcIixcbiAgICAgICAgLy8gICAgICBcIlVzZXItQWdlbnRcIjogXCIuLi5cIixcbiAgICAgICAgLy8gICAgICBcIldlYktpdC1WZXJzaW9uXCI6IFwiNTM3LjM2XCJcbiAgICAgICAgLy8gICB9XG4gICAgICAgIGNvbnN0IG91dCA9IHN0ZG91dCArIHN0ZGVycjtcbiAgICAgICAgbGV0IG1hdGNoID0gL1wiQnJvd3NlclwiOiBcIiguKilcIi8uZXhlYyhvdXQpO1xuICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICB3ZWJ2aWV3VmVyc2lvbiA9IG1hdGNoWzFdO1xuICAgICAgICAgIGxvZy5kZWJ1ZyhgV2VidmlldyB2ZXJzaW9uOiAnJHt3ZWJ2aWV3VmVyc2lvbn0nYCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBhbHNvIHByaW50IGNocm9tZWRyaXZlciB2ZXJzaW9uIHRvIGxvZ3NcbiAgICAgICAgLy8gd2lsbCBvdXRwdXQgc29tZXRoaW5nIGxpa2VcbiAgICAgICAgLy8gIFN0YXJ0aW5nIENocm9tZURyaXZlciAyLjMzLjUwNjEwNiAoOGEwNmMzOWM0NTgyZmJmYmFiNjk2NmRiYjFjMzhhOTE3M2JmYjFhMikgb24gcG9ydCA5NTE1XG4gICAgICAgIG1hdGNoID0gL1N0YXJ0aW5nIENocm9tZURyaXZlciAoWy5cXGRdKykvLmV4ZWMob3V0KTtcbiAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgbG9nLmRlYnVnKGBDaHJvbWVkcml2ZXIgdmVyc2lvbjogJyR7bWF0Y2hbMV19J2ApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZ2l2ZSB0aGUgb3V0cHV0IGlmIGl0IGlzIHJlcXVlc3RlZFxuICAgICAgICBpZiAodGhpcy52ZXJib3NlKSB7XG4gICAgICAgICAgZm9yIChsZXQgbGluZSBvZiAoc3Rkb3V0IHx8ICcnKS50cmltKCkuc3BsaXQoJ1xcbicpKSB7XG4gICAgICAgICAgICBpZiAoIWxpbmUudHJpbSgpLmxlbmd0aCkgY29udGludWU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY3VybHlcbiAgICAgICAgICAgIGxvZy5kZWJ1ZyhgW1NURE9VVF0gJHtsaW5lfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IgKGxldCBsaW5lIG9mIChzdGRlcnIgfHwgJycpLnRyaW0oKS5zcGxpdCgnXFxuJykpIHtcbiAgICAgICAgICAgIGlmICghbGluZS50cmltKCkubGVuZ3RoKSBjb250aW51ZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuICAgICAgICAgICAgbG9nLmVycm9yKGBbU1RERVJSXSAke2xpbmV9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gaGFuZGxlIG91dC1vZi1ib3VuZCBleGl0IGJ5IHNpbXBseSBlbWl0dGluZyBhIHN0b3BwZWQgc3RhdGVcbiAgICAgIHRoaXMucHJvYy5vbignZXhpdCcsIChjb2RlLCBzaWduYWwpID0+IHtcbiAgICAgICAgcHJvY2Vzc0lzQWxpdmUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgIT09IENocm9tZWRyaXZlci5TVEFURV9TVE9QUEVEICYmXG4gICAgICAgICAgICB0aGlzLnN0YXRlICE9PSBDaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBJTkcgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgIT09IENocm9tZWRyaXZlci5TVEFURV9SRVNUQVJUSU5HKSB7XG4gICAgICAgICAgbGV0IG1zZyA9IGBDaHJvbWVkcml2ZXIgZXhpdGVkIHVuZXhwZWN0ZWRseSB3aXRoIGNvZGUgJHtjb2RlfSwgYCArXG4gICAgICAgICAgICAgICAgICAgIGBzaWduYWwgJHtzaWduYWx9YDtcbiAgICAgICAgICBsb2cuZXJyb3IobXNnKTtcbiAgICAgICAgICB0aGlzLmNoYW5nZVN0YXRlKENocm9tZWRyaXZlci5TVEFURV9TVE9QUEVEKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBsb2cuaW5mbyhgU3Bhd25pbmcgY2hyb21lZHJpdmVyIHdpdGg6ICR7dGhpcy5jaHJvbWVkcml2ZXJ9IGAgK1xuICAgICAgICAgICAgICAgYCR7YXJncy5qb2luKCcgJyl9YCk7XG4gICAgICAvLyBzdGFydCBzdWJwcm9jIGFuZCB3YWl0IGZvciBzdGFydERldGVjdG9yXG4gICAgICBhd2FpdCB0aGlzLnByb2Muc3RhcnQoc3RhcnREZXRlY3Rvcik7XG4gICAgICBhd2FpdCB0aGlzLndhaXRGb3JPbmxpbmUoKTtcbiAgICAgIGF3YWl0IHRoaXMuc3RhcnRTZXNzaW9uKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhpcy5lbWl0KENocm9tZWRyaXZlci5FVkVOVF9FUlJPUiwgZSk7XG4gICAgICAvLyBqdXN0IGJlY2F1c2Ugd2UgaGFkIGFuIGVycm9yIGRvZXNuJ3QgbWVhbiB0aGUgY2hyb21lZHJpdmVyIHByb2Nlc3NcbiAgICAgIC8vIGZpbmlzaGVkOyB3ZSBzaG91bGQgY2xlYW4gdXAgaWYgbmVjZXNzYXJ5XG4gICAgICBpZiAocHJvY2Vzc0lzQWxpdmUpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9jLnN0b3AoKTtcbiAgICAgIH1cblxuICAgICAgbGV0IG1lc3NhZ2UgPSAnJztcbiAgICAgIC8vIG9mdGVuIHRoZSB1c2VyJ3MgQ2hyb21lIHZlcnNpb24gaXMgdG9vIGxvdyBmb3IgdGhlIHZlcnNpb24gb2YgQ2hyb21lZHJpdmVyXG4gICAgICBpZiAoZS5tZXNzYWdlLmluY2x1ZGVzKCdDaHJvbWUgdmVyc2lvbiBtdXN0IGJlJykpIHtcbiAgICAgICAgbWVzc2FnZSArPSAnVW5hYmxlIHRvIGF1dG9tYXRlIENocm9tZSB2ZXJzaW9uIGJlY2F1c2UgaXQgaXMgdG9vIG9sZCBmb3IgdGhpcyB2ZXJzaW9uIG9mIENocm9tZWRyaXZlci5cXG4nO1xuICAgICAgICBpZiAod2Vidmlld1ZlcnNpb24pIHtcbiAgICAgICAgICBtZXNzYWdlICs9IGBDaHJvbWUgdmVyc2lvbiBvbiB0aGUgZGV2aWNlOiAke3dlYnZpZXdWZXJzaW9ufVxcbmA7XG4gICAgICAgIH1cbiAgICAgICAgbWVzc2FnZSArPSBgVmlzaXQgJyR7Q0hST01FRFJJVkVSX1RVVE9SSUFMfScgdG8gdHJvdWJsZXNob290IHRoZSBwcm9ibGVtLlxcbmA7XG4gICAgICB9XG5cbiAgICAgIG1lc3NhZ2UgKz0gZS5tZXNzYWdlO1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3cobWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgc2Vzc2lvbklkICgpIHtcbiAgICBpZiAodGhpcy5zdGF0ZSAhPT0gQ2hyb21lZHJpdmVyLlNUQVRFX09OTElORSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuandwcm94eS5zZXNzaW9uSWQ7XG4gIH1cblxuICBhc3luYyByZXN0YXJ0ICgpIHtcbiAgICBsb2cuaW5mbyhcIlJlc3RhcnRpbmcgY2hyb21lZHJpdmVyXCIpO1xuICAgIGlmICh0aGlzLnN0YXRlICE9PSBDaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCByZXN0YXJ0IHdoZW4gd2UncmUgbm90IG9ubGluZVwiKTtcbiAgICB9XG4gICAgdGhpcy5jaGFuZ2VTdGF0ZShDaHJvbWVkcml2ZXIuU1RBVEVfUkVTVEFSVElORyk7XG4gICAgYXdhaXQgdGhpcy5zdG9wKGZhbHNlKTtcbiAgICBhd2FpdCB0aGlzLnN0YXJ0KHRoaXMuY2FwYWJpbGl0aWVzLCBmYWxzZSk7XG4gIH1cblxuICBhc3luYyB3YWl0Rm9yT25saW5lICgpIHtcbiAgICAvLyB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IENEIGhhc24ndCBjcmFzaGVkXG4gICAgbGV0IGNocm9tZWRyaXZlclN0b3BwZWQgPSBmYWxzZTtcbiAgICBhd2FpdCByZXRyeUludGVydmFsKDIwLCAyMDAsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmICh0aGlzLnN0YXRlID09PSBDaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBFRCkge1xuICAgICAgICAvLyB3ZSBhcmUgZWl0aGVyIHN0b3BwZWQgb3Igc3RvcHBpbmcsIHNvIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gICAgICAgIGNocm9tZWRyaXZlclN0b3BwZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBhd2FpdCB0aGlzLmdldFN0YXR1cygpO1xuICAgIH0pO1xuICAgIGlmIChjaHJvbWVkcml2ZXJTdG9wcGVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nocm9tZURyaXZlciBjcmFzaGVkIGR1cmluZyBzdGFydHVwLicpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFN0YXR1cyAoKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKCcvc3RhdHVzJywgJ0dFVCcpO1xuICB9XG5cbiAgYXN5bmMgc3RhcnRTZXNzaW9uICgpIHtcbiAgICAvLyByZXRyeSBzZXNzaW9uIHN0YXJ0IDQgdGltZXMsIHNvbWV0aW1lcyB0aGlzIGZhaWxzIGR1ZSB0byBhZGJcbiAgICBhd2FpdCByZXRyeUludGVydmFsKDQsIDIwMCwgYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKCcvc2Vzc2lvbicsICdQT1NUJywge2Rlc2lyZWRDYXBhYmlsaXRpZXM6IHRoaXMuY2FwYWJpbGl0aWVzfSk7XG4gICAgICAgIC8vIENocm9tZURyaXZlciBjYW4gcmV0dXJuIGEgcG9zaXRpdmUgc3RhdHVzIGRlc3BpdGUgZmFpbGluZ1xuICAgICAgICBpZiAocmVzLnN0YXR1cykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXMudmFsdWUubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgRmFpbGVkIHRvIHN0YXJ0IENocm9tZWRyaXZlciBzZXNzaW9uOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX09OTElORSk7XG4gIH1cblxuICBhc3luYyBzdG9wIChlbWl0U3RhdGVzID0gdHJ1ZSkge1xuICAgIGlmIChlbWl0U3RhdGVzKSB7XG4gICAgICB0aGlzLmNoYW5nZVN0YXRlKENocm9tZWRyaXZlci5TVEFURV9TVE9QUElORyk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLmp3cHJveHkuY29tbWFuZCgnJywgJ0RFTEVURScpO1xuICAgICAgYXdhaXQgdGhpcy5wcm9jLnN0b3AoJ1NJR1RFUk0nLCAyMDAwMCk7XG4gICAgICBpZiAoZW1pdFN0YXRlcykge1xuICAgICAgICB0aGlzLmNoYW5nZVN0YXRlKENocm9tZWRyaXZlci5TVEFURV9TVE9QUEVEKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cuZXJyb3IoZSk7XG4gICAgfVxuICB9XG5cbiAgY2hhbmdlU3RhdGUgKHN0YXRlKSB7XG4gICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgIGxvZy5kZWJ1ZyhgQ2hhbmdlZCBzdGF0ZSB0byAnJHtzdGF0ZX0nYCk7XG4gICAgdGhpcy5lbWl0KENocm9tZWRyaXZlci5FVkVOVF9DSEFOR0VELCB7c3RhdGV9KTtcbiAgfVxuXG4gIGFzeW5jIHNlbmRDb21tYW5kICh1cmwsIG1ldGhvZCwgYm9keSkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmp3cHJveHkuY29tbWFuZCh1cmwsIG1ldGhvZCwgYm9keSk7XG4gIH1cblxuICBhc3luYyBwcm94eVJlcSAocmVxLCByZXMpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5qd3Byb3h5LnByb3h5UmVxUmVzKHJlcSwgcmVzKTtcbiAgfVxuXG4gIGFzeW5jIGtpbGxBbGwgKCkge1xuICAgIGxldCBjbWQ7XG4gICAgaWYgKHN5c3RlbS5pc1dpbmRvd3MoKSkge1xuICAgICAgLy8ganMgaGludCBjYW5ub3QgaGFuZGxlIGJhY2t0aWNrcywgZXZlbiBlc2NhcGVkLCB3aXRoaW4gdGVtcGxhdGUgbGl0ZXJhbHNcbiAgICAgIGNtZCA9IFwiRk9SIC9GIFxcXCJ1c2ViYWNrcSB0b2tlbnM9NVxcXCIgJWEgaW4gKGBuZXRzdGF0IC1uYW8gXnwgXCIgK1xuICAgICAgICAgICAgXCJmaW5kc3RyIC9SIC9DOlxcXCJcIiArIHRoaXMucHJveHlQb3J0ICsgXCIgXFxcImApIGRvIChcIiArXG4gICAgICAgICAgICBcIkZPUiAvRiBcXFwidXNlYmFja3FcXFwiICViIGluIChgVEFTS0xJU1QgL0ZJIFxcXCJQSUQgZXEgJWFcXFwiIF58IFwiICtcbiAgICAgICAgICAgIFwiZmluZHN0ciAvSSBjaHJvbWVkcml2ZXIuZXhlYCkgZG8gKElGIE5PVCAlYj09XFxcIlxcXCIgVEFTS0tJTEwgXCIgK1xuICAgICAgICAgICAgXCIvRiAvUElEICVhKSlcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgY21kID0gYHBraWxsIC0xNSAtZiBcIiR7dGhpcy5jaHJvbWVkcml2ZXJ9LiotLXBvcnQ9JHt0aGlzLnByb3h5UG9ydH1cImA7XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgS2lsbGluZyBhbnkgb2xkIGNocm9tZWRyaXZlcnMsIHJ1bm5pbmc6ICR7Y21kfWApO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCAoQi5wcm9taXNpZnkoY3AuZXhlYykpKGNtZCk7XG4gICAgICBsb2cuZGVidWcoXCJTdWNjZXNzZnVsbHkgY2xlYW5lZCB1cCBvbGQgY2hyb21lZHJpdmVyc1wiKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZy53YXJuKFwiTm8gb2xkIGNocm9tZWRyaXZlcnMgc2VlbWVkIHRvIGV4aXN0XCIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFkYikge1xuICAgICAgbG9nLmRlYnVnKGBDbGVhbmluZyBhbnkgb2xkIGFkYiBmb3J3YXJkZWQgcG9ydCBzb2NrZXQgY29ubmVjdGlvbnNgKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZvciAobGV0IGNvbm4gb2YgYXdhaXQgdGhpcy5hZGIuZ2V0Rm9yd2FyZExpc3QoKSkge1xuICAgICAgICAgIC8vIGNocm9tZWRyaXZlciB3aWxsIGFzayBBREIgdG8gZm9yd2FyZCBhIHBvcnQgbGlrZSBcImRldmljZUlkIHRjcDpwb3J0IGxvY2FsYWJzdHJhY3Q6d2Vidmlld19kZXZ0b29sc19yZW1vdGVfcG9ydFwiXG4gICAgICAgICAgaWYgKGNvbm4uaW5kZXhPZignd2Vidmlld19kZXZ0b29scycpICE9PSAtMSkge1xuICAgICAgICAgICAgbGV0IHBhcmFtcyA9IGNvbm4uc3BsaXQoL1xccysvKTtcbiAgICAgICAgICAgIGlmIChwYXJhbXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFkYi5yZW1vdmVQb3J0Rm9yd2FyZChwYXJhbXNbMV0ucmVwbGFjZSgvW1xcRF0qLywgJycpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBsb2cud2FybihgVW5hYmxlIHRvIGNsZWFuIGZvcndhcmRlZCBwb3J0cy4gRXJyb3I6ICcke2Vyci5tZXNzYWdlfScuIENvbnRpbnVpbmcuYCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgaGFzV29ya2luZ1dlYnZpZXcgKCkge1xuICAgIC8vIHNvbWV0aW1lcyBjaHJvbWVkcml2ZXIgc3RvcHMgYXV0b21hdGluZyB3ZWJ2aWV3cy4gdGhpcyBtZXRob2QgcnVucyBhXG4gICAgLy8gc2ltcGxlIGNvbW1hbmQgdG8gZGV0ZXJtaW5lIG91ciBzdGF0ZSwgYW5kIHJlc3BvbmRzIGFjY29yZGluZ2x5XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKCcvdXJsJywgJ0dFVCcpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufVxuXG5DaHJvbWVkcml2ZXIuRVZFTlRfRVJST1IgPSAnY2hyb21lZHJpdmVyX2Vycm9yJztcbkNocm9tZWRyaXZlci5FVkVOVF9DSEFOR0VEID0gJ3N0YXRlQ2hhbmdlZCc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBFRCA9ICdzdG9wcGVkJztcbkNocm9tZWRyaXZlci5TVEFURV9TVEFSVElORyA9ICdzdGFydGluZyc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FID0gJ29ubGluZSc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBJTkcgPSAnc3RvcHBpbmcnO1xuQ2hyb21lZHJpdmVyLlNUQVRFX1JFU1RBUlRJTkcgPSAncmVzdGFydGluZyc7XG5cbmV4cG9ydCB7XG4gIENocm9tZWRyaXZlciwgQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HLCBnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyLCBDRF9WRVIsXG59O1xuZXhwb3J0IGRlZmF1bHQgQ2hyb21lZHJpdmVyO1xuIl0sImZpbGUiOiJsaWIvY2hyb21lZHJpdmVyLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
